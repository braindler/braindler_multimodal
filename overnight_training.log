üåô –ù–∞—á–∞–ª–æ: 19:35
‚è∞ ~8 —á–∞—Å–æ–≤ –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

üîç –°—Ñ–µ—Ä–∞ 047...
`torch_dtype` is deprecated! Use `dtype` instead!
/Users/anton/proj/ai.nativemind.net/multimodal_braindler/venv/lib/python3.13/site-packages/bitsandbytes/cextension.py:34: UserWarning: The installed version of bitsandbytes was compiled without GPU support. 8-bit optimizers, 8-bit multiplication, and GPU quantization are unavailable.
  warn("The installed version of bitsandbytes was compiled without GPU support. "
================================================================================
‚öñÔ∏è  –§–∞–π–Ω—Ç—é–Ω–∏–Ω–≥ –°—Ñ–µ—Ä—ã 047: –°–õ–ï–î–û–í–ê–¢–ï–õ–¨
================================================================================

üíª –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: Apple M4 (MPS)
üì¶ –ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å: TinyLlama/TinyLlama-1.1B-Chat-v1.0
üìö –î–∞—Ç–∞—Å–µ—Ç: datasets/legal_108_perfect.jsonl
üéØ –ú–∞–∫—Å–∏–º—É–º —à–∞–≥–æ–≤: 600 (~2 —á–∞—Å–∞)
üíæ –í—ã—Ö–æ–¥: ../models/sphere_047_m4_overnight

üì• –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞...
   ‚úÖ –¢–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∂–µ–Ω

üì• –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏...
   üçé –ò—Å–ø–æ–ª—å–∑—É–µ–º Apple Silicon MPS
   ‚úÖ –ú–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –Ω–∞ MPS
   üìä –ü–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: 1,100,048,384

üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ LoRA (–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏)...
'NoneType' object has no attribute 'cadam32bit_grad_fp32'
   ‚úÖ LoRA –ø—Ä–∏–º–µ–Ω–µ–Ω
   üéØ –û–±—É—á–∞–µ–º—ã—Ö: 1,126,400 (0.10%)
   üìä –í—Å–µ–≥–æ: 1,101,174,784

üìö –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞...
Generating train split: 0 examples [00:00, ? examples/s]Generating train split: 1512 examples [00:00, 301487.41 examples/s]
Filter:   0%|          | 0/1512 [00:00<?, ? examples/s]Filter: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1512/1512 [00:00<00:00, 197618.89 examples/s]
   üìä –ü—Ä–∏–º–µ—Ä–æ–≤ –¥–ª—è –°—Ñ–µ—Ä—ã 047: 1188

üî§ –¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è...
–¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è:   0%|          | 0/1188 [00:00<?, ? examples/s]–¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 679/1188 [00:00<00:00, 6753.12 examples/s]–¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 1188/1188 [00:00<00:00, 4160.64 examples/s]
   ‚úÖ –¢–æ–∫–µ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ: 1188 –ø—Ä–∏–º–µ—Ä–æ–≤

‚öôÔ∏è  –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è M4)...
   ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
      –≠–ø–æ—Ö: 1
      Batch size: 8
      –ì—Ä–∞–¥–∏–µ–Ω—Ç accumulation: 2
      Max steps: 600
      –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π batch: 16

üèóÔ∏è  –°–æ–∑–¥–∞–Ω–∏–µ Trainer...
Traceback (most recent call last):
  File "/Users/anton/proj/ai.nativemind.net/multimodal_braindler/finetune/finetune_overnight_m4.py", line 281, in <module>
    finetune_sphere_m4(
    ~~~~~~~~~~~~~~~~~~^
        sphere=args.sphere,
        ^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
        batch_size=args.batch_size
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/anton/proj/ai.nativemind.net/multimodal_braindler/finetune/finetune_overnight_m4.py", line 199, in finetune_sphere_m4
    trainer = Trainer(
        model=model,
    ...<2 lines>...
        data_collator=data_collator
    )
  File "/Users/anton/proj/ai.nativemind.net/multimodal_braindler/venv/lib/python3.13/site-packages/transformers/utils/deprecation.py", line 172, in wrapped_func
    return func(*args, **kwargs)
  File "/Users/anton/proj/ai.nativemind.net/multimodal_braindler/venv/lib/python3.13/site-packages/transformers/trainer.py", line 680, in __init__
    self.callback_handler = CallbackHandler(
                            ~~~~~~~~~~~~~~~^
        callbacks, self.model, self.processing_class, self.optimizer, self.lr_scheduler
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/anton/proj/ai.nativemind.net/multimodal_braindler/venv/lib/python3.13/site-packages/transformers/trainer_callback.py", line 449, in __init__
    self.add_callback(cb)
    ~~~~~~~~~~~~~~~~~^^^^
  File "/Users/anton/proj/ai.nativemind.net/multimodal_braindler/venv/lib/python3.13/site-packages/transformers/trainer_callback.py", line 466, in add_callback
    cb = callback() if isinstance(callback, type) else callback
         ~~~~~~~~^^
  File "/Users/anton/proj/ai.nativemind.net/multimodal_braindler/venv/lib/python3.13/site-packages/transformers/integrations/integration_utils.py", line 681, in __init__
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: TensorBoardCallback requires tensorboard to be installed. Either update your PyTorch version or install tensorboardX.
